==========

Todo:

1) [done] Check how to change the "Model" under "Auto Segmentation" to any of our custom models.
2) See if i can use Aorta dataset and model instead.
    - code is running our pretrained weight (3d unet) but inference is not good
    -[done] train a decent 3d unet
        - how does slicer overcome %16 or %32 size issue? I had to write a partition function for inference because of the size issue. It's from this line: self.roi_size = (128, 128, 128)  # sliding window size for train and infer
    - also check default pre/post transforms in MONAI (mostly normalization before feeding to network and interpolation on network output)

3) Using custom  network is producing (almost) identical results. 
    Need to git commit these changes.
        - Model trained on same NCWHD format.
        - In MONAI apply the same pre-processing normalization.

4) Need to add UI for uncertainty + Backend network.

===================

https://github.com/Project-MONAI/MONAILabel


How to add a new model:
https://github.com/Project-MONAI/MONAILabel/tree/main/sample-apps/radiology#how-to-add-new-model

Custom run command in tmux:
Do in tmux in case need to do force shutdown
tmux attach -t monai1
export PATH=$PATH:`pwd`/MONAILabel/monailabel/scripts

To run on GPU:
export CUDA_VISIBLE_DEVICES=3,4,5,6
To run on CPU:
export CUDA_VISIBLE_DEVICES=""

monailabel start_server --app MONAILabel/sample-apps/radiology --studies /data/saumgupta/slicer-tool/datasets/Task10_Aorta/imagesTr --conf models segmentation

monailabel start_server --app MONAILabel/sample-apps/radiology --studies /data/saumgupta/slicer-tool/datasets/Task08_IVUS/imagesTr --conf models segmentation

On local machine, open 3D Slicer 5.0.3
Open in dropdown -> Active learning -> MONAILabel

Label Server to enter:
http://localhost:8000

=====================

MONAI Slack
------------

26 July 2022
Saumya: 
Hello everyone,
My group is working on interactive segmentation with 3D Slicer. So far we are able to start the monailabel server locally and use the monai extension on 3D Slicer. We were wondering if it is possible to use our custom deep learning model for 'Auto Segmentation'. Currently the deepedit model is being used but we wanted to try our custom deep learning model. Is this possible, and if so, how should I go about it?
Thank you very much!

Andres Diaz-Pinto: 
Hi @Saumya Gupta,
I guess you mean using the segmentation model (https://github.com/Project-MONAI/MONAILabel/tree/main/sample-apps/radiology#segmentation). DeepEdit is one network that works for both tasks (auto segmentation and interactive model).
In general, there are three approaches for this:
1/ If you still have the labels you've used to create the pretrained model, you could use MONAI Label to train the model again
2/ If using the segmentation model, place the .pt file in the "model" folder with the name "pretrained_segmentation.pt", change/define the architecture you used to train the model here https://github.com/Project-MONAI/MONAILabel/blob/main/sample-apps/radiology/lib/configs/segmentation.py#L68-L76, set this label to false https://github.com/Project-MONAI/MONAILabel/blob/main/sample-apps/radiology/lib/configs/segmentation.py#L59
3/ If using DeepEdit, you have an addtional option of training a model using this tutorial (https://github.com/Project-MONAI/tutorials/tree/main/deepedit/ignite). Then export the pt file to the model older
Hope this helps

-------
03 Aug 2022

Saumya: I would like to add a new module (like Segment Editor & Scribbles) under MONAILabel in 3D Slicer. Could you point me to the relevant files to modify both front-end and back-end in order to do this?

Muhammad Asad: For 3D Slicer related updates, the most relevant files for updating the 3D Slicer client plugins are under here: https://github.com/Project-MONAI/MONAILabel/tree/main/plugins/slicer/MONAILabel

If you also wish to update server, e.g. updating scribbles, you can update/add your own modules like scribbles histogram method. The most relevant file for this is: https://github.com/Project-MONAI/MONAILabel/blob/main/monailabel/scribbles/infer.py

and it is utilised in radiology sample app here:
https://github.com/Project-MONAI/MONAILabel/blob/main/sample-apps/radiology/main.py#L118-L137 